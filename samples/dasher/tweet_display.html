<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Stream reader</title>
    <script>
    widget.config({
      "name": "tweet_display",
      "version": "1.0.0",
      "title": "Display a number of tweets",
      "desc": "Receives a bunch of tweets and displays them",
      "url": "http://github.com/premasagar/sqwidget/plugins", // get the widget, via your taskbar
      "ui" : "hostpage",
       dependencies: [
            'messaging', 'libox'
        ],
    });
    </script>
    <script type="text/javascript" charset="utf-8">
        widget.ready(function() {
            widget.setTemplate('default');
            var stream = widget.getSetting('stream'),
                currentSearchStream = widget.getSetting('current_search_stream');
            // set name of list
            // replace with set of messages
            plugins.messaging.listen(stream, function(event, tweets) {
                var feedUl = jQuery('.tweet_list', container),
                    articleHtml, i;
                
                // fill in a basic template
                for (i=tweets.tweets.length-1; i >= 0; i -= 1) {
                    articleHtml = widget.renderWithTemplate('tweet', {tweet:tweets.tweets[i]});
                    feedUl.prepend(articleHtml);
                }
            });
            plugins.messaging.listen(currentSearchStream, function(event,stuff) {
                jQuery('.tweet_list').empty();
            });
        });
    </script>
    <script type="text/template" id="loading">
        <p>Loading...</p>
    </script>
    <script type="text/template" id="tweet">
        <li>
            <div class="tweet">
                <div class="vcard">
                    <a href="http://twitter.com/{{tweet.user.screen_name}}" class="url">
                        <img style="height: 48px; width: 48px;" alt="{{tweet.user.name}}" class="photo fn" height="48" src="{{tweet.user.profile_image_url}}" width="48" />
                    </a>
                </div>
                <div class="hentry">
                    <strong>
                    <span class="entry-content"><a href="http://twitter.com/{{tweet.user.screen_name}}" title="{{tweet.user.screen_name}}">{{tweet.user.screen_name}}
                        </a></strong>
                        {{tweet.text}}</span> 
                    <span class="meta entry-meta">
                        <a href="http://twitter.com/{{tweet.user.screen_name}}/status/{{tweet.id}}" class="entry-date" rel="bookmark">
                            <span class="published" title="{{tweet.created_at}}">{{tweet.created_at}}</span>   
                        </a>
                    </span>
                </div>
            </div>
    </script>
</head>

<body>
    <ul class="tweet_list">        
    </ul>
</body>
</html>
